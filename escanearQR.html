<!DOCTYPE html>
<html>
<head>
    <title>Html-Qrcode Demo</title>
</head>
<body>
    <video id="qr-video" width="100%" height="auto"></video>
    <div id="qr-reader-results"></div>

    <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
    <script>
        function startScanner() {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(function(stream) {
                    var videoElement = document.getElementById('qr-video');
                    videoElement.srcObject = stream;
                    videoElement.play();

                    var canvas = document.createElement('canvas');
                    var canvasContext = canvas.getContext('2d');

                    function scanQRCode() {
                        canvas.width = videoElement.videoWidth;
                        canvas.height = videoElement.videoHeight;
                        canvasContext.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

                        var imageData = canvasContext.getImageData(0, 0, canvas.width, canvas.height);
                        var code = jsQR(imageData.data, imageData.width, imageData.height);

                        if (code && isURL(code.data)) {
                            console.log('QR Code:', code.data);
                            window.location.href = code.data;
                        }

                        requestAnimationFrame(scanQRCode);
                    }

                    scanQRCode();
                })
                .catch(function(error) {
                    console.error('Error accessing camera:', error);
                });
        }

        function isURL(text) {
            var urlPattern = /^(https?:\/\/)?([\w.-]+)\.([a-z]{2,})(\/\S*)?$/i;
            return urlPattern.test(text);
        }

        document.addEventListener("DOMContentLoaded", startScanner);
    </script>
</body>
</html>
